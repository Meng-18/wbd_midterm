<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - Meng Store</title>
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <nav class="navbar">
        <div class="nav-brand">
            <a href="/">MengStore</a>
        </div>
        <div class="nav-links">
            <a href="/">Home</a>
            <a href="/products">Products</a>
            <a href="/cart">Cart </a>
        </div>
    </nav>

    <main class="container">
        <h1>All Products</h1>

        <!-- Category Filters -->
        <div class="filters">
            <button class="filter-btn active" onclick="filterProducts('all')">All</button>
            <button class="filter-btn" onclick="filterProducts('Electronics')">Electronics</button>
            <button class="filter-btn" onclick="filterProducts('Clothing')">Clothing</button>
            <button class="filter-btn" onclick="filterProducts('Home')">Home</button>
            <button class="filter-btn" onclick="filterProducts('Accessories')">Accessories</button>
        </div>

        <div class="product-grid" id="productsGrid">
            <!-- Products will be loaded by JavaScript -->
        </div>
    </main>

    <script>
        let allProducts = [];
        let currentFilter = 'all';

        // Load all products when page loads
        loadProducts();

        async function loadProducts() {
            try {
                const response = await fetch('/api/products');
                allProducts = await response.json();
                displayProducts(allProducts);
            } catch (error) {
                console.error('Error loading products:', error);
            }
        }

        function displayProducts(products) {
            const productsGrid = document.getElementById('productsGrid');

            if (products.length === 0) {
                productsGrid.innerHTML = '<p>No products found in this category.</p>';
                return;
            }

            productsGrid.innerHTML = products.map(product => `
                
                <div class="product-card">
                    <a href="/products/${product.id}"><img src="${product.image}" alt="${product.name}" onerror="this.src='/images/placeholder.avif'"></a>
                    <h3>${product.name}</h3>
                    <p class="price">$${product.price}</p>
                    <p class="category">${product.category}</p>
                    <a href="/products/${product.id}" class="btn">View Details</a>
                </div>
                
            `).join('');
        }

        function filterProducts(category) {
            currentFilter = category;

            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            if (category === 'all') {
                displayProducts(allProducts);
            } else {
                const filteredProducts = allProducts.filter(product =>
                    product.category === category
                );
                displayProducts(filteredProducts);
            }
        }
    </script>
</body>

</html>